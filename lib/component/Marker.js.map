{"version":3,"sources":["../../src/component/Marker.tsx"],"names":["MarkerComponet","props","el","scene","marker","document","createElement","lnglat","children","option","onMarkerLoaded","Marker","setLnglat","setElement","addMarker","prevProps","positionChanged","toString","remove","React","SceneContext","Consumer","PureComponent"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;;AAYA;;AACA;;AACA;;;;;;IAOqBA,c;;;;;AAInB,0BAAYC,KAAZ,EAAiC;AAAA;;AAAA;AAC/B,8BAAMA,KAAN;AAD+B,UAHzBC,EAGyB;AAAA,UAFzBC,KAEyB;AAAA,UADzBC,MACyB;AAE/B,UAAKF,EAAL,GAAUG,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAV;AAF+B;AAGhC;;;;wCAC0B;AAAA,wBAC4B,KAAKL,KADjC;AAAA,UACjBM,MADiB,eACjBA,MADiB;AAAA,UACTC,QADS,eACTA,QADS;AAAA,UACCC,MADD,eACCA,MADD;AAAA,UACSC,cADT,eACSA,cADT;AAEzB,UAAMN,MAAM,GAAG,IAAIO,SAAJ,CAAWF,MAAX,CAAf;;AACA,UAAIF,MAAJ,EAAY;AACVH,QAAAA,MAAM,CAACQ,SAAP,CAAiBL,MAAjB;AACD;;AACD,UAAIC,QAAJ,EAAc;AACZJ,QAAAA,MAAM,CAACS,UAAP,CAAkB,KAAKX,EAAvB;AACD;;AACD,WAAKE,MAAL,GAAcA,MAAd;;AACA,UAAIM,cAAJ,EAAoB;AAClBA,QAAAA,cAAc,CAACN,MAAD,CAAd;AACD;;AACD,WAAKD,KAAL,CAAWW,SAAX,CAAqBV,MAArB;AACD;;;uCACyBW,S,EAAyB;AAAA;;AACjD,UAAMC,eAAe,GACnB,CAAAD,SAAS,SAAT,IAAAA,SAAS,WAAT,YAAAA,SAAS,CAAER,MAAX,CAAkBU,QAAlB,yBAAiC,KAAKhB,KAAtC,iDAAiC,aAAYM,MAAZ,CAAmBU,QAAnB,EAAjC,CADF;;AAGA,UAAID,eAAJ,EAAqB;AACnB,aAAKZ,MAAL,CAAYQ,SAAZ,CAAsB,KAAKX,KAAL,CAAWM,MAAjC;AACD;AACF;;;2CAC6B;AAC5B,UAAI,KAAKH,MAAT,EAAiB;AACf,aAAKA,MAAL,CAAYc,MAAZ;AACD;AACF;;;6BAEe;AAAA;;AACd,aAAOC,KAAK,CAACb,aAAN,CACLc,2BAAaC,QADR,EAGL,EAHK,EAIL,UAAClB,KAAD,EAAkB;AAChB,YAAIA,KAAJ,EAAW;AACT,UAAA,MAAI,CAACA,KAAL,GAAaA,KAAb;AACD;;AAED,eAAO,4BAAa,MAAI,CAACF,KAAL,CAAWO,QAAxB,EAAkC,MAAI,CAACN,EAAvC,CAAP;AACD,OAVI,CAAP;AAYD;;;EAlDyCiB,KAAK,CAACG,a","sourcesContent":["import {\n  IActiveOption,\n  IImage,\n  ILayer,\n  ILngLat,\n  IMarker,\n  IMarkerOption,\n  IPoint,\n  Marker,\n  Popup,\n  Scene,\n} from '@antv/l7';\nimport * as React from 'react';\nimport { createPortal } from 'react-dom';\nimport { SceneContext } from './SceneContext';\ninterface IMarkerProps {\n  option?: IMarkerOption;\n  lnglat: ILngLat | number[];\n  onMarkerLoaded?: (marker: IMarker) => void;\n  children?: React.ReactNode;\n}\nexport default class MarkerComponet extends React.PureComponent<IMarkerProps> {\n  private el: HTMLDivElement;\n  private scene: Scene;\n  private marker: IMarker;\n  constructor(props: IMarkerProps) {\n    super(props);\n    this.el = document.createElement('div');\n  }\n  public componentDidMount() {\n    const { lnglat, children, option, onMarkerLoaded } = this.props;\n    const marker = new Marker(option);\n    if (lnglat) {\n      marker.setLnglat(lnglat as ILngLat | IPoint);\n    }\n    if (children) {\n      marker.setElement(this.el);\n    }\n    this.marker = marker;\n    if (onMarkerLoaded) {\n      onMarkerLoaded(marker);\n    }\n    this.scene.addMarker(marker);\n  }\n  public componentDidUpdate(prevProps: IMarkerProps) {\n    const positionChanged =\n      prevProps?.lnglat.toString() !== this.props?.lnglat.toString();\n\n    if (positionChanged) {\n      this.marker.setLnglat(this.props.lnglat as ILngLat | IPoint);\n    }\n  }\n  public componentWillUnmount() {\n    if (this.marker) {\n      this.marker.remove();\n    }\n  }\n\n  public render() {\n    return React.createElement(\n      SceneContext.Consumer,\n      // @ts-ignore\n      {},\n      (scene: Scene) => {\n        if (scene) {\n          this.scene = scene;\n        }\n\n        return createPortal(this.props.children, this.el);\n      },\n    );\n  }\n}\n"],"file":"Marker.js"}
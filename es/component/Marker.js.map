{"version":3,"sources":["../../src/component/Marker.tsx"],"names":["Marker","React","createPortal","SceneContext","MarkerComponet","props","el","scene","marker","document","createElement","lnglat","children","option","onMarkerLoaded","setLnglat","setElement","addMarker","prevProps","positionChanged","toString","remove","Consumer","PureComponent"],"mappings":";;;;;;;;;;AAAA,SAQEA,MARF,QAWO,UAXP;AAYA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,SAASC,YAAT,QAA6B,WAA7B;AACA,SAASC,YAAT,QAA6B,gBAA7B;;IAOqBC,c;;;;;AAInB,0BAAYC,KAAZ,EAAiC;AAAA;;AAAA;;AAC/B,8BAAMA,KAAN;AAD+B,UAHzBC,EAGyB;AAAA,UAFzBC,KAEyB;AAAA,UADzBC,MACyB;AAE/B,UAAKF,EAAL,GAAUG,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAV;AAF+B;AAGhC;;;;wCAC0B;AAAA,wBAC4B,KAAKL,KADjC;AAAA,UACjBM,MADiB,eACjBA,MADiB;AAAA,UACTC,QADS,eACTA,QADS;AAAA,UACCC,MADD,eACCA,MADD;AAAA,UACSC,cADT,eACSA,cADT;AAEzB,UAAMN,MAAM,GAAG,IAAIR,MAAJ,CAAWa,MAAX,CAAf;;AACA,UAAIF,MAAJ,EAAY;AACVH,QAAAA,MAAM,CAACO,SAAP,CAAiBJ,MAAjB;AACD;;AACD,UAAIC,QAAJ,EAAc;AACZJ,QAAAA,MAAM,CAACQ,UAAP,CAAkB,KAAKV,EAAvB;AACD;;AACD,WAAKE,MAAL,GAAcA,MAAd;;AACA,UAAIM,cAAJ,EAAoB;AAClBA,QAAAA,cAAc,CAACN,MAAD,CAAd;AACD;;AACD,WAAKD,KAAL,CAAWU,SAAX,CAAqBT,MAArB;AACD;;;uCACyBU,S,EAAyB;AAAA;;AACjD,UAAMC,eAAe,GACnB,CAAAD,SAAS,SAAT,IAAAA,SAAS,WAAT,YAAAA,SAAS,CAAEP,MAAX,CAAkBS,QAAlB,yBAAiC,KAAKf,KAAtC,iDAAiC,aAAYM,MAAZ,CAAmBS,QAAnB,EAAjC,CADF;;AAGA,UAAID,eAAJ,EAAqB;AACnB,aAAKX,MAAL,CAAYO,SAAZ,CAAsB,KAAKV,KAAL,CAAWM,MAAjC;AACD;AACF;;;2CAC6B;AAC5B,UAAI,KAAKH,MAAT,EAAiB;AACf,aAAKA,MAAL,CAAYa,MAAZ;AACD;AACF;;;6BAEe;AAAA;;AACd,aAAOpB,KAAK,CAACS,aAAN,CACLP,YAAY,CAACmB,QADR,EAGL,EAHK,EAIL,UAACf,KAAD,EAAkB;AAChB,YAAIA,KAAJ,EAAW;AACT,UAAA,MAAI,CAACA,KAAL,GAAaA,KAAb;AACD;;AAED,eAAOL,YAAY,CAAC,MAAI,CAACG,KAAL,CAAWO,QAAZ,EAAsB,MAAI,CAACN,EAA3B,CAAnB;AACD,OAVI,CAAP;AAYD;;;;EAlDyCL,KAAK,CAACsB,a;;SAA7BnB,c","sourcesContent":["import {\n  IActiveOption,\n  IImage,\n  ILayer,\n  ILngLat,\n  IMarker,\n  IMarkerOption,\n  IPoint,\n  Marker,\n  Popup,\n  Scene,\n} from '@antv/l7';\nimport * as React from 'react';\nimport { createPortal } from 'react-dom';\nimport { SceneContext } from './SceneContext';\ninterface IMarkerProps {\n  option?: IMarkerOption;\n  lnglat: ILngLat | number[];\n  onMarkerLoaded?: (marker: IMarker) => void;\n  children?: React.ReactNode;\n}\nexport default class MarkerComponet extends React.PureComponent<IMarkerProps> {\n  private el: HTMLDivElement;\n  private scene: Scene;\n  private marker: IMarker;\n  constructor(props: IMarkerProps) {\n    super(props);\n    this.el = document.createElement('div');\n  }\n  public componentDidMount() {\n    const { lnglat, children, option, onMarkerLoaded } = this.props;\n    const marker = new Marker(option);\n    if (lnglat) {\n      marker.setLnglat(lnglat as ILngLat | IPoint);\n    }\n    if (children) {\n      marker.setElement(this.el);\n    }\n    this.marker = marker;\n    if (onMarkerLoaded) {\n      onMarkerLoaded(marker);\n    }\n    this.scene.addMarker(marker);\n  }\n  public componentDidUpdate(prevProps: IMarkerProps) {\n    const positionChanged =\n      prevProps?.lnglat.toString() !== this.props?.lnglat.toString();\n\n    if (positionChanged) {\n      this.marker.setLnglat(this.props.lnglat as ILngLat | IPoint);\n    }\n  }\n  public componentWillUnmount() {\n    if (this.marker) {\n      this.marker.remove();\n    }\n  }\n\n  public render() {\n    return React.createElement(\n      SceneContext.Consumer,\n      // @ts-ignore\n      {},\n      (scene: Scene) => {\n        if (scene) {\n          this.scene = scene;\n        }\n\n        return createPortal(this.props.children, this.el);\n      },\n    );\n  }\n}\n"],"file":"Marker.js"}
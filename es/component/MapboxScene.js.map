{"version":3,"sources":["../../src/component/MapboxScene.tsx"],"names":["Scene","Mapbox","React","createElement","createRef","useEffect","useState","SceneContext","MapboxScene","memo","props","style","className","map","option","onSceneLoaded","container","scene","setScene","sceneInstance","id","current","on","destroy","setMapStyle","JSON","stringify","zoom","setZoom","center","setCenter","pitch","setPitch","rotation","setRotation","ref","children"],"mappings":"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","sourcesContent":["import { IMapConfig, ISceneConfig, Scene, Zoom } from '@antv/l7';\n// @ts-ignore\n// tslint:disable-next-line:no-submodule-imports\nimport { Mapbox } from '@antv/l7-maps';\nimport React, { createElement, createRef, useEffect, useState } from 'react';\nimport { SceneContext } from './SceneContext';\ninterface IMapSceneConig {\n  style?: React.CSSProperties;\n  className?: string;\n  map: Partial<IMapConfig>;\n  option?: Partial<ISceneConfig>;\n  children?: React.ReactNode;\n  onSceneLoaded?: (scene: Scene) => void;\n}\nconst MapboxScene = React.memo((props: IMapSceneConig) => {\n  const { style, className, map, option, onSceneLoaded } = props;\n  const container = createRef();\n  const [scene, setScene] = useState<Scene>();\n\n  // 地图初始\n  useEffect(() => {\n    const sceneInstance = new Scene({\n      id: container.current as HTMLDivElement,\n      ...option,\n      map: new Mapbox(map),\n    });\n    sceneInstance.on('loaded', () => {\n      setScene(sceneInstance);\n      if (onSceneLoaded) {\n        onSceneLoaded(sceneInstance);\n      }\n    });\n    return () => {\n      sceneInstance.destroy();\n    };\n  }, []);\n\n  // 更新地图样式\n  useEffect(() => {\n    if (scene && map.style) {\n      scene.setMapStyle(map.style);\n    }\n  }, [JSON.stringify(map.style)]);\n\n  useEffect(() => {\n    if (scene && map.zoom) {\n      scene.setZoom(map.zoom);\n    }\n  }, [map.zoom]);\n\n  useEffect(() => {\n    if (scene && map.center) {\n      scene.setCenter(map.center);\n    }\n  }, [JSON.stringify(map.center)]);\n  useEffect(() => {\n    if (scene && map.pitch) {\n      scene.setPitch(map.pitch);\n    }\n  }, [map.pitch]);\n  useEffect(() => {\n    if (scene && map.rotation) {\n      scene.setRotation(map.rotation);\n    }\n  }, [map.rotation]);\n\n  return (\n    <SceneContext.Provider value={scene}>\n      {createElement(\n        'div',\n        {\n          ref: container,\n          style,\n          className,\n        },\n        scene && props.children,\n      )}\n    </SceneContext.Provider>\n  );\n});\n\nexport default MapboxScene;\n"],"file":"MapboxScene.js"}
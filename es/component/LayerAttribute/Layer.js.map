{"version":3,"sources":["../../../src/component/LayerAttribute/Layer.tsx"],"names":["CityBuildingLayer","HeatmapLayer","ImageLayer","LineLayer","PointLayer","PolygonLayer","RasterLayer","React","LayerContext","useSceneValue","Active","Animate","Color","Filter","Scale","Select","Shape","Size","Source","Style","useEffect","useState","BaseLayer","type","props","source","color","shape","style","size","scale","active","select","filter","animate","options","onLayerLoaded","mapScene","layer","setLayer","l","on","undefined","addLayer","removeLayer","render","inited","updateLayerConfig","minZoom","maxZoom","visible","zIndex","setIndex","blend","setBlend","children"],"mappings":"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","sourcesContent":["import {\n  CityBuildingLayer,\n  HeatmapLayer,\n  ILayer,\n  ImageLayer,\n  LineLayer,\n  PointLayer,\n  PolygonLayer,\n  RasterLayer,\n  Scene,\n} from '@antv/l7';\nimport * as React from 'react';\nimport { LayerContext } from '../LayerContext';\nimport { useSceneValue } from '../SceneContext';\nimport {\n  Active,\n  Animate,\n  Color,\n  Filter,\n  ILayerProps,\n  Scale,\n  Select,\n  Shape,\n  Size,\n  Source,\n  Style,\n} from './';\n\nconst { useEffect, useState } = React;\n\nexport default function BaseLayer(type: string, props: ILayerProps) {\n  const {\n    source,\n    color,\n    shape,\n    style,\n    size,\n    scale,\n    active,\n    select,\n    filter,\n    animate,\n    options,\n    onLayerLoaded,\n  } = props;\n  const mapScene = (useSceneValue() as unknown) as Scene;\n  const [layer, setLayer] = useState<ILayer>();\n  if (!layer) {\n    let l: ILayer;\n    switch (type) {\n      case 'polygonLayer':\n        l = new PolygonLayer(options);\n        break;\n      case 'lineLayer':\n        l = new LineLayer(options);\n        break;\n      case 'pointLayer':\n        l = new PointLayer(options);\n        break;\n      case 'heatmapLayer':\n        l = new HeatmapLayer(options);\n        break;\n      case 'rasterLayer':\n        l = new RasterLayer(options);\n        break;\n      case 'imageLayer':\n        l = new ImageLayer(options);\n        break;\n      case 'citybuildingLayer':\n        l = new CityBuildingLayer(options);\n        break;\n      default:\n        l = new PolygonLayer(options);\n    }\n    l.on('inited', () => {\n      if (onLayerLoaded) {\n        onLayerLoaded(l, mapScene);\n      }\n    });\n    setLayer(l);\n  }\n\n  useEffect(() => {\n    if (layer !== undefined) {\n      mapScene.addLayer(layer as ILayer);\n      return () => {\n        mapScene.removeLayer(layer as ILayer);\n      };\n    }\n  }, []);\n  useEffect(() => {\n    // 重绘layer\n    if (layer) {\n      mapScene.render();\n    }\n  });\n\n  useEffect(() => {\n    if (layer && layer.inited && options) {\n      layer.updateLayerConfig(options);\n    }\n  }, [options?.minZoom, options?.maxZoom, options?.visible]);\n\n  useEffect(() => {\n    if (layer && layer.inited && options && options.zIndex) {\n      layer.setIndex(options.zIndex);\n    }\n  }, [options?.zIndex]);\n\n  useEffect(() => {\n    if (layer && layer.inited && options && options.blend) {\n      layer.setBlend(options.blend);\n    }\n  }, [options?.blend]);\n\n  return layer !== null && layer !== undefined ? (\n    <LayerContext.Provider value={layer}>\n      <Source layer={layer} source={source} />\n      {scale && <Scale layer={layer} scale={scale} />}\n      {color && <Color layer={layer} color={color} />}\n      {size && <Size layer={layer} size={size} />}\n      {shape && <Shape layer={layer} shape={shape} />}\n      {style && <Style layer={layer} style={style} />}\n      {active && <Active layer={layer} active={active} />}\n      {select && <Select layer={layer} select={select} />}\n      {filter && <Filter layer={layer} filter={filter} />}\n      {animate && <Animate layer={layer} animate={animate} />}\n      {/* LayerContext主要传入LayerEvent组件 */}\n      {props.children}\n    </LayerContext.Provider>\n  ) : null;\n}\n"],"file":"Layer.js"}